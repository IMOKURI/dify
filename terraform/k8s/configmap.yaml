apiVersion: v1
kind: ConfigMap
metadata:
  name: dify-config
  namespace: dify
data:
  # Application URLs (update these with your domain)
  CONSOLE_API_URL: "https://your-domain.com"
  CONSOLE_WEB_URL: "https://your-domain.com"
  SERVICE_API_URL: "https://your-domain.com"
  APP_API_URL: "https://your-domain.com"
  APP_WEB_URL: "https://your-domain.com"
  FILES_URL: "https://your-domain.com"
  
  # Basic settings
  LANG: "C.UTF-8"
  LC_ALL: "C.UTF-8"
  PYTHONIOENCODING: "utf-8"
  LOG_LEVEL: "INFO"
  LOG_OUTPUT_FORMAT: "text"
  DEBUG: "false"
  FLASK_DEBUG: "false"
  DEPLOY_ENV: "PRODUCTION"
  
  # Database type
  DB_TYPE: "postgresql"
  DB_USERNAME: "postgres"
  DB_PORT: "5432"
  DB_DATABASE: "dify"
  
  # Redis (will be set by Terraform outputs)
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  REDIS_USE_SSL: "false"
  
  # Celery
  CELERY_BACKEND: "redis"
  
  # CORS
  WEB_API_CORS_ALLOW_ORIGINS: "*"
  CONSOLE_CORS_ALLOW_ORIGINS: "*"
  
  # Storage (GCS)
  STORAGE_TYPE: "opendal"
  OPENDAL_SCHEME: "gcs"
  
  # Vector store
  VECTOR_STORE: "weaviate"
  WEAVIATE_ENDPOINT: "http://weaviate:8080"
  WEAVIATE_GRPC_ENDPOINT: "grpc://weaviate:50051"
  
  # Code execution
  CODE_EXECUTION_ENDPOINT: "http://sandbox:8194"
  CODE_EXECUTION_SSL_VERIFY: "False"
  
  # Worker settings
  SERVER_WORKER_AMOUNT: "1"
  SERVER_WORKER_CLASS: "gevent"
  CELERY_WORKER_CLASS: "default"
  
  # File upload limits
  UPLOAD_FILE_SIZE_LIMIT: "15"
  UPLOAD_FILE_BATCH_LIMIT: "5"
  
  # ETL
  ETL_TYPE: "dify"
  
  # Enable features
  MIGRATION_ENABLED: "true"
  SCARF_NO_ANALYTICS: "true"
  
  # Sandbox
  SANDBOX_GIN_MODE: "release"
  SANDBOX_WORKER_TIMEOUT: "15"
  SANDBOX_ENABLE_NETWORK: "true"
  SANDBOX_HTTP_PROXY: "http://ssrf-proxy:3128"
  SANDBOX_HTTPS_PROXY: "http://ssrf-proxy:3128"
  SANDBOX_PORT: "8194"
  
  # SSRF Proxy
  SSRF_HTTP_PORT: "3128"
  SSRF_REVERSE_PROXY_PORT: "8194"
  SSRF_SANDBOX_HOST: "sandbox"
  
  # Weaviate settings
  WEAVIATE_PERSISTENCE_DATA_PATH: "/var/lib/weaviate"
  WEAVIATE_QUERY_DEFAULTS_LIMIT: "25"
  WEAVIATE_AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED: "false"
  WEAVIATE_DEFAULT_VECTORIZER_MODULE: "none"
  WEAVIATE_CLUSTER_HOSTNAME: "node1"
  WEAVIATE_AUTHENTICATION_APIKEY_ENABLED: "true"
  WEAVIATE_AUTHENTICATION_APIKEY_USERS: "hello@dify.ai"
  WEAVIATE_AUTHORIZATION_ADMINLIST_ENABLED: "true"
  WEAVIATE_AUTHORIZATION_ADMINLIST_USERS: "hello@dify.ai"
  
  # Plugin settings
  PLUGIN_DAEMON_PORT: "5002"
  PLUGIN_DAEMON_URL: "http://plugin-daemon:5002"
  PLUGIN_DIFY_INNER_API_URL: "http://api:5001"
  PLUGIN_STORAGE_TYPE: "gcs"
  
  # Marketplace
  MARKETPLACE_ENABLED: "true"
  MARKETPLACE_API_URL: "https://marketplace.dify.ai"
